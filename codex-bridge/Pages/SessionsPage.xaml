<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="codex_bridge.Pages.SessionsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="using:codex_bridge.ViewModels"
    mc:Ignorable="d">

    <Grid Padding="24" RowDefinitions="Auto,Auto,*,Auto" RowSpacing="16">
        
        <!-- é¡µé¢æ ‡é¢˜ -->
        <TextBlock Text="ä¼šè¯" Style="{StaticResource TitleTextBlockStyle}" />

        <!-- å·¥å…·æ  -->
        <Border
            Grid.Row="1"
            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
            BorderThickness="1"
            CornerRadius="8"
            Padding="12">
            <Grid ColumnDefinitions="Auto,Auto,*,Auto" ColumnSpacing="12">
                <Button x:Name="RefreshButton" Click="RefreshButton_Click">
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <SymbolIcon Symbol="Refresh" />
                        <TextBlock Text="åˆ·æ–°" />
                    </StackPanel>
                </Button>
                <Button x:Name="CreateButton" Grid.Column="1" Click="CreateButton_Click" Style="{StaticResource AccentButtonStyle}">
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <SymbolIcon Symbol="Add" />
                        <TextBlock Text="æ–°å»ºä¼šè¯" />
                    </StackPanel>
                </Button>
                <TextBox
                    x:Name="CwdTextBox"
                    Grid.Column="2"
                    PlaceholderText="å·¥ä½œåŒºç›®å½•ï¼ˆå¿…å¡«ï¼Œä¾‹å¦‚ C:\repo\projectï¼‰" />
                <TextBlock x:Name="StatusTextBlock" Grid.Column="3" VerticalAlignment="Center" Opacity="0.7" />
            </Grid>
        </Border>

        <!-- ä¼šè¯åˆ—è¡¨ -->
        <ListView
            x:Name="SessionsListView"
            Grid.Row="2"
            IsItemClickEnabled="True"
            ItemClick="SessionsListView_ItemClick"
            ItemsSource="{x:Bind Sessions, Mode=OneWay}"
            SelectionMode="None">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Setter Property="Padding" Value="0,4" />
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.ItemTemplate>
                <DataTemplate x:DataType="vm:SessionSummaryViewModel">
                    <Border
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="16,12"
                        RightTapped="SessionItem_RightTapped">
                        <Grid ColumnDefinitions="Auto,*,Auto">
                            <!-- Status icons -->
                            <StackPanel Orientation="Horizontal" Spacing="4" VerticalAlignment="Center">
                                <FontIcon Glyph="&#xE718;" FontSize="12" Visibility="{x:Bind IsPinned}" />
                                <FontIcon Glyph="&#xED1A;" FontSize="12" Visibility="{x:Bind IsHidden}" />
                            </StackPanel>
                            <StackPanel Grid.Column="1" Spacing="4" Margin="8,0,0,0">
                                <TextBlock
                                    Text="{x:Bind Title}"
                                    Style="{StaticResource BodyStrongTextBlockStyle}"
                                    TextTrimming="CharacterEllipsis" />
                                <TextBlock
                                    Opacity="0.7"
                                    Text="{x:Bind Subtitle}"
                                    TextTrimming="CharacterEllipsis" />
                                <TextBlock
                                    Opacity="0.5"
                                    FontSize="12"
                                    Text="{x:Bind Id}"
                                    FontFamily="Cascadia Code,Consolas,monospace"
                                    TextTrimming="CharacterEllipsis" />
                            </StackPanel>
                            <SymbolIcon
                                Grid.Column="2"
                                Symbol="Forward"
                                VerticalAlignment="Center"
                                Opacity="0.5" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- åº•éƒ¨æç¤º -->
        <Border
            Grid.Row="3"
            Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
            CornerRadius="4"
            Padding="12,8">
            <TextBlock
                Opacity="0.8"
                Text="ðŸ’¡ ç‚¹å‡»ä¼šè¯å°†è®¾ç½®ä¸ºå½“å‰ä¼šè¯å¹¶è·³è½¬åˆ°èŠå¤©é¡µï¼ˆç”¨äºŽæ¢å¤å¯¹è¯ï¼‰" />
        </Border>
    </Grid>
</Page>
